<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<title>客户_手动创建页面_给固定模板</title>
		<link rel="stylesheet" href="../../css/pc/public/public.css" />
		<!--<link rel="stylesheet" href="../../css/phone/public/swiper.min.css" />-->
		<link rel="stylesheet" href="../../css/pc/edit_index.css" />
		<link rel="stylesheet" href="">
	</head>
  <style>
 
  </style>
	<body>
		<div class="wrapper" id="edit_app_wrap">
			<div class="tab">
				<ul class="tabs clearfloat">
					<li class="active">
						<a href="" data-toggle="0">首页编辑</a>
					</li>
					<li>
						<a href="" data-toggle="1">分类</a>
					</li>
					<li>
						<a href="" data-toggle="2">购物车</a>
					</li>
					<li>
						<a href="" data-toggle="3">个人中心</a>
					</li>
				</ul>
			</div>
			<!--首页编辑-->
			<div class="content clearfloat">
				<!--left box-->
				<div class="left_box">
					<!--功能插件-->
					<div class="left_box_fun_box clearfloat">
						<p class="fun_box_top">功能插件</p>
						<div class="fun_box_content clearfloat">
							<!--项-->
							<p class="fun_box_content_term"  v-for="(v,i) in componentTerm" @click="comTremFun(v.id)">{{v.name}}</p>
						</div>
					</div>
				</div>
				<!--中间 box-->
				<div class="middle_box">
					<!--绝对定位=>设置图片，模拟手机-->
					<p class="phone_top"></p>
					<p class="phone_left"></p>
					<p class="phone_right"></p>
					<!--模拟手机的 wrap，背景图两边（img）-->
					<div class="html_wrpa">
						<!--水平居中-->
						<div class="html_box">
							<!--隐藏滚动条-->
							<div class="html_box_new">
								<!--拖拽-包着拖拽的div-->
								<div class="drag_box" v-for="(v,i) in backData"  
									draggable="true" 
									@dragstart="handleDragStart($event, v)" 
									@dragover.prevent="handleDragOver($event, v)" 
									@dragenter="handleDragEnter($event, v)" 
									@dragend="handleDragEnd($event, v)">
									<!--轮播图 box，拖拽的div-->
									<div class="modle_box" v-if="v.id == 'rotationId'? true:''" :key="v.id" @click="editMode(v.id,v.key_num)">
										<div class="slide">
											<div class="slide_item">
												<img  :src="v.data.imgUrl[0]" alt="" />
											</div>
											<div class="slide_but" :style="{'text-align':v.params.butPosition}">
												<!--第一个，模拟点击时颜色-->
												<span :class="v.params.butStyle" :style="{'background':v.params.clickColor}"></span>
												<span :class="v.params.butStyle" :style="{'background':v.params.butColor}"></span>
												<span :class="v.params.butStyle" :style="{'background':v.params.butColor}"></span>
											</div>
										</div>
										<div class="cursor_box remove_ele">
											<!--1、删除按钮，生成html=>删除(remove_ele)-->
											<p class="cursor_box_del" onclick="removerEle(this)">删除</p >
										</div>
									</div>
									
									<!--搜索模块 box，拖拽的div-->
									<div class="modle_box" v-if="v.id == 'searchId'? true:''" :key="v.id" @click="editMode(v.id,v.key_num)">
										<div class="search" :style="{'background':v.params.backColor}">
											<form action="#" :style="{'border-color':v.params.borderColor}" :class="v.params.reStyle">
												<input type="submit" class="searchBtn" value="">
												<input type="text" class="searchText" placeholder="搜索：输入关键字在店内搜索" :style="{'color':v.params.textColor}" v-model="v.data.tipeText">
											</form>
										</div>
									</div>
									<!-- 按钮组 拖拽div -->
									<div class="drag_box" v-if="v.id == 'bottonsId'? true:''" :key="v.id" @click="editMode(v.id,v.key_num)">
										<!--模块 box-->
										<div class="modle_box">
											<div class="modle_bottons rim-mod-select modle-mod "  style="background-color: rgb(255, 255, 255);">
												<div   class="botton-scope">
													<a href="unsafe:javascript:;">
														<div class="modle_mod_nav"  style="width: 20%;">
															<div class="modle_mod_img">
																<img   src="../../img/pc/phone/d058ccbf6c81800aedd20eb5b43533fa828b4752.jpg" style=" height: 39px;">
															</div>
															<div class="modle_mod_text">按钮文字</div>
														</div>
													</a>
												</div>
												<div class="botton-scope">
													<a href="unsafe:javascript:;">
														<div class="modle_mod_nav"  style="width: 20%;">
															<div class="modle_mod_img">
																<img   src="../../img/pc/phone/d058ccbf6c81800aedd20eb5b43533fa828b4752.jpg" style=" height: 39px;">
															</div>
															<div class="modle_mod_text">按钮文字</div>
														</div>
													</a>
												</div>
												<div class="botton-scope">
													<a href="unsafe:javascript:;">
														<div class="modle_mod_nav"  style="width: 20%;">
															<div class="modle_mod_img">
																<img   src="../../img/pc/phone/d058ccbf6c81800aedd20eb5b43533fa828b4752.jpg" style=" height: 39px;">
															</div>
															<div class="modle_mod_text">按钮文字</div>
														</div>
													</a>
												</div>
												<div class="botton-scope">
													<a href="unsafe:javascript:;">
														<div class="modle_mod_nav"  style="width: 20%;">
															<div class="modle_mod_img">
																<img   src="../../img/pc/phone/d058ccbf6c81800aedd20eb5b43533fa828b4752.jpg" style="border-radius: 0px; height: 39px;">
															</div>
															<div class="modle_mod_text">按钮文字</div>
														</div>
													</a>
												</div>
												<div class="botton-scope">
													<a href="unsafe:javascript:;">
														<div class="modle_mod_nav"  style="width: 20%;">
															<div class="modle_mod_img">
																<img   src="../../img/pc/phone/d058ccbf6c81800aedd20eb5b43533fa828b4752.jpg" style="border-radius: 0px; height: 39px;">
															</div>
															<div class="modle_mod_text">按钮文字</div>
														</div>
													</a>
												</div>
											</div>
										</div>
									</div>
									
									
								</div>
								
							</div>
							<!--隐藏滚动条-->
							
						</div>
					</div>
					<!--模拟手机的 wrap，背景图两边（img）-->
					<p class="phone_bottom"></p>
				</div>
				<!--编辑模板 box-->
				<div class="right_box">
					<!-- 轮播图--编辑 -->
					<div class="edit_modle" v-show="puStateObj['id'] == 'rotationId'">
						<div class="edit_slide">
							<div class="slide_title">轮播设置</div>
							<div class="edit_slide_content">
								<span class="edit_slide_content_title">按钮形状</span>										
								<label class="edit_slide_content_label"><input type="radio" v-model="backData[puStateObj['key_num']].params.butStyle" value="rectangle">长方形</label>
								<label class="edit_slide_content_label"><input type="radio" v-model="backData[puStateObj['key_num']].params.butStyle" value="square">正方形</label>
								<label class="edit_slide_content_label"><input type="radio" v-model="backData[puStateObj['key_num']].params.butStyle" value="roundness">圆形</label>
							</div>
							<div class="edit_slide_content">
								<span class="edit_slide_content_title">按钮位置</span>
								<label class="edit_slide_content_label"><input type="radio" v-model="backData[puStateObj['key_num']].params.butPosition" value="left">按钮居左</label>
								<label class="edit_slide_content_label"><input type="radio" v-model="backData[puStateObj['key_num']].params.butPosition" value="center">按钮居中</label>
								<label class="edit_slide_content_label"><input type="radio" v-model="backData[puStateObj['key_num']].params.butPosition" value="right">按钮居右</label>

							</div>
							<div class="edit_slide_content">
								<span class="edit_slide_content_title">按钮背景颜色</span>
								<input type="color" v-model="backData[puStateObj['key_num']].params.butColor" value="backData[puStateObj['key_num']].params.butColor">
							</div>
							<div class="edit_slide_content">
								<span class="edit_slide_content_title">按钮点击颜色</span>
								<input type="color" v-model="backData[puStateObj['key_num']].params.clickColor" value="backData[puStateObj['key_num']].params.clickColor">
							</div>
							
						</div>		
					</div>
					
					<!-- 搜索编辑 -->
					<div class="edit_modle" v-show="puStateObj['id'] == 'searchId'">
						<!-- 编辑模板 -->
						<div class="edit_search">
							<div class="editor_icon"></div>
							<div class="editor_title">搜索框设置</div>
		
							<div class="editor_line">
								<div class="editor_name">提示文字</div>
								<div class="editor_con">
									<input class="editor_input1" placeholder="搜索框默认提示文字，超出屏幕宽度将自动隐藏"  v-model="backData[puStateObj['key_num']].data.tipeText">
								</div>
							</div>
		
							<div class="editor_line">
								<div class="editor_name">选择样式</div>
								<div class="editor_con">
									<label><input type="radio" v-model="backData[puStateObj['key_num']].params.reStyle" value="style1"> 样式一</label>
									<label><input type="radio" v-model="backData[puStateObj['key_num']].params.reStyle" value="style2"> 样式二</label>
								</div>
							</div>
		
							<div class="editor_line">
								<div class="editor_name">文字颜色</div>
								<div class="editor_con">
									<input class="editor_input2" type="color" v-model="backData[puStateObj['key_num']].params.textColor">
									<span class="tips">提示: 输入文字颜色</span>
								</div>
							</div>
		
							<div class="editor_line">
								<div class="editor_name">边框颜色</div>
								<div class="editor_con">
									<input class="editor_input2" type="color" v-model="backData[puStateObj['key_num']].params.borderColor">
								</div>
							</div>
		
							<div class="editor_line">
								<div class="editor_name">背景颜色</div>
								<div class="editor_con">
									<input class="editor_input2" type="color" v-model="backData[puStateObj['key_num']].params.backColor">
								</div>
							</div>
						</div>
					</div>

				</div>
			</div>
			<!-- 分类 -->
			<div class="content clearfloat" style="display:none">
				<!--中间 box-->
				<div class="middle_box">
					<!--绝对定位=>设置图片，模拟手机-->
					<p class="phone_top"></p>
					<p class="phone_left"></p>
					<p class="phone_right"></p>
					<!--模拟手机的 wrap，背景图两边（img）-->
					<div class="html_wrpa">
						<!--水平居中-->
						<div class="html_box">
							<iframe src="../phone/classify/classify.html"></iframe>
						</div>
					</div>
					<p class="phone_bottom"></p>
				</div>
			</div>
			<!-- 购物车 -->
			<div class="content clearfloat" style="display:none">
				<!--中间 box-->
				<div class="middle_box">
					<!--绝对定位=>设置图片，模拟手机-->
					<p class="phone_top"></p>
					<p class="phone_left"></p>
					<p class="phone_right"></p>
					<!--模拟手机的 wrap，背景图两边（img）-->
					<div class="html_wrpa">
						<!--水平居中-->
						<div class="html_box">
							<!--隐藏滚动条-->
							<!--<div class="html_box_new"">-->
							<iframe class="html_box_new" src="../phone/shopping_cart/shopping_cart.html" frameborder="0"></iframe>
							<!--</div>-->
						</div>
					</div>
					<p class="phone_bottom"></p>
				</div>
			</div>
			<!-- 个人中心 -->
			<div class="content clearfloat" style="display:none">
				<!--中间 box-->
				<div class="middle_box">
					<!--绝对定位=>设置图片，模拟手机-->
					<p class="phone_top"></p>
					<p class="phone_left"></p>
					<p class="phone_right"></p>
					<!--模拟手机的 wrap，背景图两边（img）-->
					<div class="html_wrpa">
						<!--水平居中-->
						<div class="html_box" style="overflow: hidden;">
							<!--隐藏滚动条-->
								<iframe class="html_box_new" src="../phone/my/user.html"></iframe>
						</div>
					</div>
				
					<p class="phone_bottom"></p>
				</div>
			</div>
			
			<!--底部 wrap-->
			<div class="bottom_wrap">
				<p class="bottom_wrap_deposit hover_box" @click="depositFun()">保存模板</p>
			</div>
		</div>

		<script src="../../js/pc/public/jquery-1.8.3.js"></script>
		<!--public的js-->
		<!--<script src="../../js/pc/edit_index.js"></script>-->
		
		<script>
			$(document).ready(function() {

				// tba切换
				$(".tabs>li>a").click(function(e) {
					e.preventDefault();
					var $tar = $(e.target);
					var index = $tar.attr('data-toggle')
					if($tar.is("[data-toggle]")) {
						$tar.parent().addClass('active').siblings().removeClass('active')
						$('.wrapper').children('.content').eq(index).show().siblings('.content').hide()
					}
				})

			})
		</script>
		<script src="../../js/pc/public/vue.js"></script>
		<script>
			// 深克隆，把引用数据类型的，分解成基础类型（克隆）
			// 第一个参数是数据，第二参数是数组或对象(想转换的类型)
			function clones(_type, _memory){
				var newMemory = null;
				// 判断传过来的数据类型
				if(_type instanceof Array) {
					newMemory = _memory || [];
				} else {
					newMemory = _memory || {};
				}
				for(var x in _type) {
					//引用数据类型的 typeof为 object
					if(typeof _type[x] == "object") {
						newMemory[x] = (_type[x].constructor == Array) ? [] : {};
						clones(_type[x], newMemory[x]); //递归
					} else {
						// 数据赋值
						newMemory[x] = _type[x];
					}
				}
				return newMemory;
			}
			
			var newVue = new Vue({
				el: "#edit_app_wrap",
				data: {					
					/*组件-选项*/
					componentTerm: [
						{name:"轮播",id:'rotationId'},
						{name:"搜索框",id:'searchId'},
						{name:"按钮组",id:'bottonsId'},
						{name:"店招",id:'signageId'},
						{name:"商品组",id:'productListId'},
						{name:"公告",id:'noticeId'},
						{name:"辅助空白",id:'blankId'},
						{name:"广告",id:'bannerId'},
						{name:'标题',id:'titleId'}
					],
					
					/*拖拽需要的元素*/
					dragging: null,
					/**
					 * 公共-对应显示-模板编辑;
					 * id:判断模块；
					 * key_num:判断-模块在页面的排序
					 * **/
					puStateObj: {
						id: null,
						/*初始化*/
						key_num: 0,
					},
					/* 页面渲染data || 传个后台-data ，对象形式*/
					backData: [
						/**初始化=>生产对应组件=>删除第一条数据array[0]。
						 * 如果，编辑页面=>先删除-下面的数据。
						 * **/
						{
							params:{},
							data:{}
						},
					],
					/*轮播图，数据初始化*/
					roObj:{
						/**组件id*/
						id:"rotationId",
						/**组件名*/
						temp:"rotation",
						/*页面渲染-组件位置，从0开始*/
						key_num: null,
						/**组件style*/
						params:{									
							/*'rectangle' =>长方形，'square' =>正方形，'roundness'=>圆形*/
							butStyle: 'rectangle',
							/*'left'=>左，'center'=>中间，'right'=>右*/
							butPosition: 'center',
							/*按钮背景颜色，必须是16进制的色值，不能简写*/
							butColor: '#000000',	
							/*按钮点击时的颜色，必须是16进制的色值，不能简写*/
							clickColor: '#f5f5f5',
						},
						data:{
							/*轮播的图片路径*/
							imgUrl:[
								'../../img/0005.png',
								'../../img/0005.png',
								'../../img/0005.png',	
							],
						},
					},
					/*搜索框，数据初始化*/
					seObj: {
						/**组件id*/
						id:"searchId",
						/**组件名*/
						temp:"search",
						/*页面渲染-组件位置，从0开始*/
						key_num: null,
						/**组件style*/
						params:{									
							/*0=>样式一，1=>样式二*/
							reStyle: 'style1',
							/*文字颜色*/
							textColor: '',
							/*边框颜色*/
							borderColor: '',
							/*背景颜色*/
							backColor: '',
						},
						data:{
							/*提示文字*/
							tipeText: '搜索：输入关键字在店内搜索',
						},
					},
					// 按钮组，数据初始化
					boObj: {
						/*id*/
						id:"bottonsId",
						temp:'bottons',
						key_num: null,
						params:{
							/*图标样式*/
							iconStyle: 0,
							/*0=>样式一，1=>样式二*/
							iconNum: '20%',
							/*背景颜色*/
							iconColor: '',
							iconList:[
								{id:'1',text:'按钮文字',texts:"",location:'',url:'../../img/pc/phone/d058ccbf6c81800aedd20eb5b43533fa828b4752.jpg',siezColor:'39'},
								{id:'2',text:'按钮文字',texts:"",location:'',url:'../../img/pc/phone/d058ccbf6c81800aedd20eb5b43533fa828b4752.jpg',siezColor:'39'},
								{id:'3',text:'按钮文字',texts:"",location:'',url:'../../img/pc/phone/d058ccbf6c81800aedd20eb5b43533fa828b4752.jpg',siezColor:'39'},
								{id:'4',text:'按钮文字',texts:"",location:'',url:'../../img/pc/phone/d058ccbf6c81800aedd20eb5b43533fa828b4752.jpg',siezColor:'39'},
								{id:'5',text:'按钮文字',texts:"",location:'',url:'../../img/pc/phone/d058ccbf6c81800aedd20eb5b43533fa828b4752.jpg',siezColor:'39',show:0}
							]	
						}
						
					},
			
				},
				methods: {
					/*<< 拖拽*/
					handleDragStart(e, item) {
						this.dragging = item;
					},
					handleDragEnd(e, item) {
						this.dragging = null
					},
					//首先把div变成可以放置的元素，即重写dragenter/dragover
					handleDragOver(e) {
						e.dataTransfer.dropEffect = 'move' // e.dataTransfer.dropEffect="move";//在dragenter中针对放置目标来设置!
					},
					handleDragEnter(e, item) {
						e.dataTransfer.effectAllowed = "move" //为需要移动的元素设置dragstart事件
						if(item === this.dragging) {
							return
						}
						/*pc数据渲染的data*/
						const newItems = [...this.backData]
						const src = newItems.indexOf(this.dragging)
						const dst = newItems.indexOf(item)

						newItems.splice(dst, 0, ...newItems.splice(src, 1));
						/*重置--pc数据渲染的data*/
						this.backData = newItems;
						console.log('传-后台=>"拖拽" ',this.backData);
					},
					/* 拖拽 >>*/
					/*组件选项-按钮*/
					comTremFun(_id){
						var that = this;
						/*轮播图*/
						if(_id === 'rotationId'){
							/*赋值对应的模块=>页面位置key_num*/
							that.roObj['key_num'] = that.backData.length;
							/*深克隆=>页面渲染-data*/
							that.backData.push(clones(that.roObj));
//							console.log(that.backData[0]['id']);
							/**(一次性)--删除-backData[0]的初始数据(用来双向绑定)
							 * 该函数-'最后'执行的语句;
							 * **/
							if(that.backData[0]['id'] == undefined){
								that.backData.shift();
								that.backData[0]['key_num'] = 0;
								console.log('清除掉-无用的值（数据双向绑定！）！');
							}
							console.log('传给后台数据',that.backData);
							return false;
							
						}
						/*搜索框*/
						if(_id === "searchId"){
							that.seObj['key_num'] = that.backData.length;
							that.backData.push(clones(that.seObj));
							/*改if语句-放在最后*/
							if(that.backData[0]['id'] == undefined){
								that.backData.shift();
								that.backData[0]['key_num'] = 0;
								console.log('清除掉-无用的值（数据双向绑定！）！');
							}
							return false;
						}
						/*按钮组*/
						if(_id === "bottonsId"){
							that.boObj['key_num'] = that.backData.length;
							that.backData.push(clones(that.boObj));
							/*改if语句-放在最后*/
							if(that.backData[0]['id'] == undefined){
								that.backData.shift();
								that.backData[0]['key_num'] = 0;
								console.log('清除掉-无用的值（数据双向绑定！）！');
							}
							return false;
						}
						
						
						
						
					},
					/*编辑对应的模板*/
					editMode(_id,_key){
						console.log('点击对应模板:',_id,_key);
						this.puStateObj = {
							id: _id,
							key_num: _key
						}
						console.log('对应的模板：',this.puStateObj);
					},	
					/*保存-模板*/
					depositFun(){
						console.log('保存模板！！',this.backData);
					} 
					
				},
				
			});
			
		</script>
	</body>

</html>